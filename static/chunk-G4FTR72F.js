import{a as w}from"./chunk-EMFRQSN7.js";import{c as z}from"./chunk-Y3VUQSNC.js";import{b as R,d as W,g as P,s as U}from"./chunk-P7DOQO73.js";import{$ as x,Cb as A,Ga as S,Gb as o,Hb as v,Hc as $,Ia as l,Ib as u,Kb as k,Lb as V,Lc as b,Mb as F,Nb as N,Oa as _,Va as T,Xb as j,Za as g,_ as C,aa as E,ba as D,ia as f,lb as c,mb as r,nb as t,ob as y,sb as I,tb as M,tc as L,ub as h,uc as H,wb as p,xb as d,zc as O}from"./chunk-J3KRFXTR.js";function G(n,i){if(n&1&&(I(0),y(1,"img",27),M()),n&2){let e=d().$implicit;l(),c("alt",N(e.name))("src",e.image_url,S)}}function q(n,i){if(n&1&&(r(0,"span",28),o(1),t()),n&2){let e=d().$implicit;l(),v(e.name.charAt(0).toUpperCase())}}function J(n,i){if(n&1){let e=h();r(0,"tr")(1,"td",16)(2,"div",17)(3,"div",18),g(4,G,2,3,"ng-container",19)(5,q,2,1,"ng-template",null,0,j),t(),r(7,"div",20)(8,"div",21),o(9),t()()()(),r(10,"td",22),o(11),t(),r(12,"td",23),o(13),t(),r(14,"td",23),o(15),t(),r(16,"td",24)(17,"button",25),p("click",function(){let s=C(e).$implicit,m=d();return x(m.editCategory(s))}),o(18," Editar "),t(),r(19,"button",26),p("click",function(){let s=C(e).$implicit,m=d();return x(m.deleteCategory(s))}),o(20," Eliminar "),t()()()}if(n&2){let e=i.$implicit,a=A(6),s=d();l(4),c("ngIf",e.image_url)("ngIfElse",a),l(5),v(e.name),l(2),u(" ",e.description||"Sin descripci\xF3n"," "),l(2),u(" ",(e.parent_category==null?null:e.parent_category.name)||"Categor\xEDa ra\xEDz"," "),l(2),u(" ",s.formatDate(e.created_at)," ")}}function K(n,i){if(n&1){let e=h();r(0,"button",4),p("click",function(){C(e);let s=d(2);return x(s.openCreateModal())}),o(1," Crear Primera Categor\xEDa "),t()}}function Q(n,i){if(n&1&&(r(0,"div",29)(1,"div",30),E(),r(2,"svg",31),y(3,"path",32),t()(),D(),r(4,"h3",33),o(5),t(),r(6,"p",34),o(7),t(),g(8,K,2,0,"button",35),t()),n&2){let e=d();l(5),u(" ",e.searchTerm?"No se encontraron categor\xEDas":"No hay categor\xEDas"," "),l(2),u(" ",e.searchTerm?"Intenta con otros t\xE9rminos de b\xFAsqueda":"Comienza creando tu primera categor\xEDa"," "),l(),c("ngIf",!e.searchTerm)}}function X(n,i){n&1&&(r(0,"div",36),y(1,"div",37),t())}var B=class n{constructor(i,e){this.http=i;this.dialog=e}categories=f([]);filteredCategories=f([]);loading=f(!1);error=f(null);searchTerm="";ngOnInit(){this.loadCategories()}openCreateModal(){this.dialog.open(w,{data:{mode:"create",categories:this.categories()},width:"500px",maxWidth:"90vw"}).closed.subscribe(e=>{e&&this.loadCategories()})}editCategory(i){this.dialog.open(w,{data:{category:i,mode:"edit",categories:this.categories()},width:"500px",maxWidth:"90vw"}).closed.subscribe(a=>{a&&this.loadCategories()})}loadCategories(){this.loading.set(!0),this.http.get(`${b.apiUrl}/categories`).subscribe({next:i=>{this.categories.set(i),this.filteredCategories.set(i),this.loading.set(!1)},error:i=>{this.error.set("Error loading categories"),this.loading.set(!1),console.error("Error loading categories:",i)}})}filterCategories(){let i=this.categories();this.searchTerm&&(i=i.filter(e=>e.name.toLowerCase().includes(this.searchTerm.toLowerCase())||e.description&&e.description.toLowerCase().includes(this.searchTerm.toLowerCase()))),this.filteredCategories.set(i)}deleteCategory(i){confirm("\xBFEst\xE1 seguro de eliminar esta categor\xEDa?")&&this.http.delete(`${b.apiUrl}/categories/${i.category_id}`).subscribe({next:()=>{this.loadCategories()},error:e=>{console.error("Error deleting category:",e)}})}formatDate(i){return new Date(i).toLocaleDateString("es-ES")}static \u0275fac=function(e){return new(e||n)(_($),_(z))};static \u0275cmp=T({type:n,selectors:[["app-admin-categories"]],decls:27,vars:4,consts:[["initial",""],[1,"p-6"],[1,"flex","justify-between","items-center","mb-6"],[1,"text-2xl","font-bold","text-gray-900"],[1,"bg-primary-600","text-white","px-4","py-2","rounded-lg","hover:bg-primary-700","transition-colors",3,"click"],[1,"bg-white","p-4","rounded-lg","shadow","mb-6"],["type","text","placeholder","Buscar categor\xEDas...",1,"w-full","px-4","py-2","border","rounded-lg","focus:ring-2","focus:ring-primary-500","focus:border-transparent",3,"ngModelChange","input","ngModel"],[1,"bg-white","rounded-lg","shadow","overflow-hidden"],[1,"overflow-x-auto"],[1,"min-w-full","divide-y","divide-gray-200"],[1,"bg-gray-50"],[1,"px-6","py-3","text-left","text-xs","font-medium","text-gray-500","uppercase","tracking-wider"],[1,"bg-white","divide-y","divide-gray-200"],[4,"ngFor","ngForOf"],["class","text-center py-12",4,"ngIf"],["class","flex justify-center py-8",4,"ngIf"],[1,"px-6","py-4","whitespace-nowrap"],[1,"flex","items-center"],[1,"w-10","h-10","rounded-full","flex","items-center","justify-center","bg-gray-100","overflow-hidden","border"],[4,"ngIf","ngIfElse"],[1,"ml-4"],[1,"text-sm","font-medium","text-gray-900"],[1,"px-6","py-4","text-sm","text-gray-900"],[1,"px-6","py-4","whitespace-nowrap","text-sm","text-gray-900"],[1,"px-6","py-4","whitespace-nowrap","text-sm","font-medium"],[1,"text-primary-600","hover:text-primary-900","mr-3",3,"click"],[1,"text-red-600","hover:text-red-900",3,"click"],[1,"object-cover","w-full","h-full",3,"src","alt"],[1,"text-white","text-sm","font-medium","bg-purple-600","w-full","h-full","flex","items-center","justify-center"],[1,"text-center","py-12"],[1,"mx-auto","w-24","h-24","bg-gray-100","rounded-full","flex","items-center","justify-center","mb-4"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"w-12","h-12","text-gray-400"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M19 11H5m14 0a2 2 0 012 2v6a2 2 0 01-2 2H5a2 2 0 01-2-2v-6a2 2 0 012-2m14 0V9a2 2 0 00-2-2M5 11V9a2 2 0 012-2m0 0V5a2 2 0 012-2h6a2 2 0 012 2v2M7 7h10"],[1,"text-lg","font-medium","text-gray-900","mb-2"],[1,"text-gray-500","mb-4"],["class","bg-primary-600 text-white px-4 py-2 rounded-lg hover:bg-primary-700 transition-colors",3,"click",4,"ngIf"],[1,"flex","justify-center","py-8"],[1,"animate-spin","rounded-full","h-8","w-8","border-b-2","border-primary-600"]],template:function(e,a){e&1&&(r(0,"div",1)(1,"div",2)(2,"h1",3),o(3,"Gesti\xF3n de Categor\xEDas"),t(),r(4,"button",4),p("click",function(){return a.openCreateModal()}),o(5," Crear Categor\xEDa "),t()(),r(6,"div",5)(7,"input",6),F("ngModelChange",function(m){return V(a.searchTerm,m)||(a.searchTerm=m),m}),p("input",function(){return a.filterCategories()}),t()(),r(8,"div",7)(9,"div",8)(10,"table",9)(11,"thead",10)(12,"tr")(13,"th",11),o(14," Categor\xEDa "),t(),r(15,"th",11),o(16," Descripci\xF3n "),t(),r(17,"th",11),o(18," Categor\xEDa Padre "),t(),r(19,"th",11),o(20," Fecha de Creaci\xF3n "),t(),r(21,"th",11),o(22," Acciones "),t()()(),r(23,"tbody",12),g(24,J,21,6,"tr",13),t()()(),g(25,Q,9,3,"div",14),t(),g(26,X,2,0,"div",15),t()),e&2&&(l(7),k("ngModel",a.searchTerm),l(17),c("ngForOf",a.filteredCategories()),l(),c("ngIf",!a.loading()&&a.filteredCategories().length===0),l(),c("ngIf",a.loading()))},dependencies:[O,L,H,U,R,W,P],encapsulation:2})};export{B as AdminCategoriesComponent};
