import{a as q}from"./chunk-E5HTAP5X.js";import{a as R}from"./chunk-KWCMDIYP.js";import{a as A}from"./chunk-PR4QG5UI.js";import{a as V,d as B,g as O}from"./chunk-D3C3HQLZ.js";import"./chunk-TWZ67XBU.js";import{$ as f,Ga as w,Gb as o,Hb as m,Ia as d,Ib as y,Oa as u,Tb as M,Ub as P,Va as I,Za as v,_ as x,aa as C,ba as S,ia as p,lb as c,mb as r,nb as i,ob as g,sb as E,tb as k,tc as T,ub as _,uc as D,wb as h,wc as j,xb as l,zc as N}from"./chunk-J3KRFXTR.js";function L(a,t){if(a&1&&(E(0),g(1,"img",13),k()),a&2){let e=l(2);d(),c("src",e.category().image_url,w)("alt",e.category().name)}}function H(a,t){if(a&1&&(r(0,"div",9),v(1,L,2,2,"ng-container",10),r(2,"h1",11),o(3),i(),r(4,"p",12),o(5),i()()),a&2){let e=l();d(),c("ngIf",e.category().image_url),d(2),m(e.category().name),d(2),m(e.category().description)}}function z(a,t){a&1&&(r(0,"div",14),g(1,"div",15),i())}function $(a,t){if(a&1){let e=_();r(0,"div",16)(1,"div",17),C(),r(2,"svg",18),g(3,"path",19),i()(),S(),r(4,"h3",20),o(5,"Error al cargar los productos"),i(),r(6,"p",21),o(7),i(),r(8,"button",22),h("click",function(){x(e);let s=l();return f(s.loadProducts())}),o(9," Intentar de nuevo "),i()()}if(a&2){let e=l();d(7),m(e.error())}}function G(a,t){if(a&1){let e=_();r(0,"div",35)(1,"div",36),g(2,"img",37),i(),r(3,"div",38)(4,"h3",39),o(5),i(),r(6,"p",40),o(7),i(),r(8,"div",41)(9,"span",42),o(10),M(11,"number"),i(),r(12,"button",43),h("click",function(){let s=x(e).$implicit,b=l(2);return f(b.addToCart(s))}),o(13),i()(),r(14,"div",44),o(15),i()()()}if(a&2){let e=t.$implicit;d(2),c("src",(e.images==null||e.images[0]==null?null:e.images[0].image_url)||"/placeholder-product.jpg",w)("alt",e.name),d(3),m(e.name),d(2),m(e.description),d(3),y(" ","$"+P(11,8,e.price,"1.2-2")," "),d(2),c("disabled",e.stock_quantity===0),d(),y(" ",e.stock_quantity===0?"Sin Stock":"Agregar"," "),d(2),y(" Stock: ",e.stock_quantity," unidades ")}}function U(a,t){if(a&1){let e=_();r(0,"div",23)(1,"div",24)(2,"h2",25),o(3),i(),r(4,"div",26)(5,"label",27),o(6,"Ordenar por:"),i(),r(7,"select",28),h("change",function(s){x(e);let b=l();return f(b.onSortChange(s))}),r(8,"option",29),o(9,"Nombre"),i(),r(10,"option",30),o(11,"Precio: Menor a Mayor"),i(),r(12,"option",31),o(13,"Precio: Mayor a Menor"),i(),r(14,"option",32),o(15,"M\xE1s Recientes"),i()()()(),r(16,"div",33),v(17,G,16,11,"div",34),i()()}if(a&2){let e=l();d(3),y(" Productos (",e.products().length,") "),d(14),c("ngForOf",e.products())}}function J(a,t){a&1&&(r(0,"div",16)(1,"div",45),C(),r(2,"svg",46),g(3,"path",47),i()(),S(),r(4,"h3",20),o(5,"No hay productos en esta categor\xEDa"),i(),r(6,"p",12),o(7,"Prueba buscando en otras categor\xEDas o vuelve m\xE1s tarde."),i()())}var F=class a{constructor(t,e,n,s){this.route=t;this.productsService=e;this.categoriesService=n;this.cartService=s}category=p(null);products=p([]);loading=p(!1);error=p(null);sortBy=p("name");categoryId=null;ngOnInit(){this.route.paramMap.subscribe(t=>{this.categoryId=t.get("id"),this.categoryId&&(this.loadCategory(),this.loadProducts())})}loadCategory(){this.categoryId&&this.categoriesService.getAllCategories().subscribe({next:t=>{let e=t.find(n=>n.category_id===parseInt(this.categoryId));this.category.set(e||null)},error:t=>{console.error("Error loading category:",t)}})}loadProducts(){this.categoryId&&(this.loading.set(!0),this.error.set(null),this.productsService.getProductsByCategory(parseInt(this.categoryId)).subscribe({next:t=>{this.products.set(t),this.sortProducts(),this.loading.set(!1)},error:t=>{console.error("Error loading products:",t),this.error.set("No se pudieron cargar los productos"),this.loading.set(!1)}}))}onSortChange(t){this.sortBy.set(t.target.value),this.sortProducts()}sortProducts(){let t=[...this.products()];switch(this.sortBy()){case"name":t.sort((n,s)=>n.name.localeCompare(s.name));break;case"price_asc":t.sort((n,s)=>n.price-s.price);break;case"price_desc":t.sort((n,s)=>s.price-n.price);break;case"newest":t.sort((n,s)=>new Date(s.created_at||"").getTime()-new Date(n.created_at||"").getTime());break}this.products.set(t)}addToCart(t){t.stock_quantity!==0&&this.cartService.addToCart({product_id:t.product_id,quantity:1}).subscribe({next:e=>{console.log("Product added to cart:",e)},error:e=>{console.error("Error adding product to cart:",e)}})}static \u0275fac=function(e){return new(e||a)(u(V),u(q),u(R),u(A))};static \u0275cmp=I({type:a,selectors:[["app-category"]],decls:14,vars:6,consts:[[1,"max-w-7xl","mx-auto","px-4","sm:px-6","lg:px-8","py-8"],[1,"mb-8"],[1,"flex","items-center","space-x-2","text-sm","text-gray-500","mb-4"],["routerLink","/",1,"hover:text-primary-600"],[1,"text-gray-900"],["class","bg-white rounded-lg shadow-sm p-6 mb-6",4,"ngIf"],["class","flex justify-center items-center py-12",4,"ngIf"],["class","text-center py-12",4,"ngIf"],["class","bg-white rounded-lg shadow-sm p-6",4,"ngIf"],[1,"bg-white","rounded-lg","shadow-sm","p-6","mb-6"],[4,"ngIf"],[1,"text-3xl","font-bold","text-gray-900","mb-2"],[1,"text-gray-600"],[1,"w-24","h-24","object-cover","rounded-full","mx-auto","mb-4","border","border-gray-200",3,"src","alt"],[1,"flex","justify-center","items-center","py-12"],[1,"animate-spin","rounded-full","h-12","w-12","border-b-2","border-primary-600"],[1,"text-center","py-12"],[1,"text-red-600","mb-4"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"w-12","h-12","mx-auto"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M12 8v4m0 4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"],[1,"text-lg","font-medium","text-gray-900","mb-2"],[1,"text-gray-600","mb-4"],[1,"bg-primary-600","text-white","px-4","py-2","rounded-md","hover:bg-primary-700","transition-colors",3,"click"],[1,"bg-white","rounded-lg","shadow-sm","p-6"],[1,"flex","justify-between","items-center","mb-6"],[1,"text-xl","font-bold","text-gray-900"],[1,"flex","items-center","space-x-4"],[1,"text-sm","text-gray-600"],[1,"border","border-gray-300","rounded-md","px-3","py-1","text-sm","focus:ring-2","focus:ring-primary-500","focus:border-transparent",3,"change"],["value","name"],["value","price_asc"],["value","price_desc"],["value","newest"],[1,"grid","grid-cols-1","sm:grid-cols-2","lg:grid-cols-3","xl:grid-cols-4","gap-6"],["class","bg-white border border-gray-200 rounded-lg overflow-hidden hover:shadow-lg transition-shadow",4,"ngFor","ngForOf"],[1,"bg-white","border","border-gray-200","rounded-lg","overflow-hidden","hover:shadow-lg","transition-shadow"],[1,"aspect-w-1","aspect-h-1","bg-gray-200"],[1,"w-full","h-48","object-cover",3,"src","alt"],[1,"p-4"],[1,"text-lg","font-medium","text-gray-900","mb-2","line-clamp-2"],[1,"text-sm","text-gray-600","mb-3","line-clamp-2"],[1,"flex","items-center","justify-between"],[1,"text-2xl","font-bold","text-primary-600"],[1,"bg-primary-600","text-white","px-4","py-2","rounded-md","hover:bg-primary-700","disabled:bg-gray-400","disabled:cursor-not-allowed","transition-colors","text-sm","font-medium",3,"click","disabled"],[1,"mt-2","text-xs","text-gray-500"],[1,"text-gray-400","mb-4"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"w-16","h-16","mx-auto"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M20 13V6a2 2 0 00-2-2H6a2 2 0 00-2 2v7m16 0v5a2 2 0 01-2 2H6a2 2 0 01-2-2v-5m16 0h-2M4 13h2m13-8l-4-4m0 0L9 5m6 0v4"]],template:function(e,n){if(e&1&&(r(0,"div",0)(1,"div",1)(2,"nav",2)(3,"a",3),o(4,"Inicio"),i(),r(5,"span"),o(6,"/"),i(),r(7,"span",4),o(8),i()(),v(9,H,6,3,"div",5),i(),v(10,z,2,0,"div",6)(11,$,10,1,"div",7)(12,U,18,2,"div",8)(13,J,8,0,"div",7),i()),e&2){let s;d(8),m(((s=n.category())==null?null:s.name)||"Categor\xEDa"),d(),c("ngIf",n.category()),d(),c("ngIf",n.loading()),d(),c("ngIf",n.error()),d(),c("ngIf",!n.loading()&&!n.error()&&n.products().length>0),d(),c("ngIf",!n.loading()&&!n.error()&&n.products().length===0)}},dependencies:[N,T,D,O,B,j],encapsulation:2})};export{F as CategoryComponent};
