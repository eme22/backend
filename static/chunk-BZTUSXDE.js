import{h as N}from"./chunk-HYBTYU64.js";import{a as U}from"./chunk-H5RDGQN3.js";import{b as D,d as L,e as B,f as A,g as j,h as k,q,s as R}from"./chunk-3BSRKISZ.js";import{c as I}from"./chunk-ZXTFQK7X.js";import"./chunk-TYBCTD6A.js";import{$ as p,Eb as C,Fc as W,Gb as l,Hb as S,Ia as s,Ib as b,Ic as x,Kb as u,Lb as c,Mb as f,Oa as _,Va as F,Za as E,_ as m,ia as h,lb as w,mb as n,nb as o,sc as T,ub as v,wb as y,xb as d,xc as V}from"./chunk-7IT3E43U.js";function H(g,a){if(g&1){let r=v();n(0,"div",15)(1,"form",16),y("ngSubmit",function(){m(r);let e=d();return p(e.updateProfile())}),n(2,"div",17)(3,"div")(4,"label",18),l(5," Nombre de Usuario "),o(),n(6,"input",19),f("ngModelChange",function(e){m(r);let i=d();return c(i.profileForm.username,e)||(i.profileForm.username=e),p(e)}),o()(),n(7,"div")(8,"label",18),l(9," Email "),o(),n(10,"input",20),f("ngModelChange",function(e){m(r);let i=d();return c(i.profileForm.email,e)||(i.profileForm.email=e),p(e)}),o()(),n(11,"div")(12,"label",18),l(13," Nombre(s) "),o(),n(14,"input",21),f("ngModelChange",function(e){m(r);let i=d();return c(i.profileForm.first_name,e)||(i.profileForm.first_name=e),p(e)}),o()(),n(15,"div")(16,"label",18),l(17," Apellido(s) "),o(),n(18,"input",22),f("ngModelChange",function(e){m(r);let i=d();return c(i.profileForm.last_name,e)||(i.profileForm.last_name=e),p(e)}),o()(),n(19,"div")(20,"label",18),l(21," Tel\xE9fono "),o(),n(22,"input",23),f("ngModelChange",function(e){m(r);let i=d();return c(i.profileForm.phone,e)||(i.profileForm.phone=e),p(e)}),o()()(),n(23,"div")(24,"label",18),l(25," Direcci\xF3n "),o(),n(26,"textarea",24),f("ngModelChange",function(e){m(r);let i=d();return c(i.profileForm.address,e)||(i.profileForm.address=e),p(e)}),o()(),n(27,"div",25)(28,"button",26),l(29),o()()()()}if(g&2){let r=d();s(6),u("ngModel",r.profileForm.username),s(4),u("ngModel",r.profileForm.email),s(4),u("ngModel",r.profileForm.first_name),s(4),u("ngModel",r.profileForm.last_name),s(4),u("ngModel",r.profileForm.phone),s(4),u("ngModel",r.profileForm.address),s(2),w("disabled",r.loading()),s(),b(" ",r.loading()?"Guardando...":"Guardar Cambios"," ")}}function O(g,a){if(g&1){let r=v();n(0,"div",15)(1,"form",16),y("ngSubmit",function(){m(r);let e=d();return p(e.changePassword())}),n(2,"div")(3,"label",18),l(4," Contrase\xF1a Actual "),o(),n(5,"input",27),f("ngModelChange",function(e){m(r);let i=d();return c(i.passwordForm.currentPassword,e)||(i.passwordForm.currentPassword=e),p(e)}),o()(),n(6,"div")(7,"label",18),l(8," Nueva Contrase\xF1a "),o(),n(9,"input",28),f("ngModelChange",function(e){m(r);let i=d();return c(i.passwordForm.newPassword,e)||(i.passwordForm.newPassword=e),p(e)}),o()(),n(10,"div")(11,"label",18),l(12," Confirmar Nueva Contrase\xF1a "),o(),n(13,"input",29),f("ngModelChange",function(e){m(r);let i=d();return c(i.passwordForm.confirmPassword,e)||(i.passwordForm.confirmPassword=e),p(e)}),o()(),n(14,"div",25)(15,"button",26),l(16),o()()()()}if(g&2){let r=d();s(5),u("ngModel",r.passwordForm.currentPassword),s(4),u("ngModel",r.passwordForm.newPassword),s(4),u("ngModel",r.passwordForm.confirmPassword),s(2),w("disabled",r.loading()),s(),b(" ",r.loading()?"Cambiando...":"Cambiar Contrase\xF1a"," ")}}var G=class g{constructor(a,r,t,e){this.http=a;this.router=r;this.toastrService=t;this.authService=e}user=h(null);loading=h(!1);activeTab="profile";profileForm={username:"",email:"",first_name:"",last_name:"",phone:"",address:""};passwordForm={currentPassword:"",newPassword:"",confirmPassword:""};ngOnInit(){this.loadUserProfile()}loadUserProfile(){this.loading.set(!0),this.http.get(`${x.apiUrl}/users/profile`).subscribe({next:a=>{this.user.set(a),this.profileForm={username:a.username,email:a.email,first_name:a.first_name||"",last_name:a.last_name||"",phone:a.phone||"",address:a.address||""},this.loading.set(!1)},error:a=>{this.loading.set(!1),this.toastrService.error("Error al cargar perfil","Error"),console.error("Error loading profile:",a)}})}updateProfile(){this.loading.set(!0),this.http.put(`${x.apiUrl}/users/${this.user()?.user_id}`,this.profileForm).subscribe({next:a=>{this.user.set(a),this.loading.set(!1),this.toastrService.success("Perfil actualizado exitosamente","\xC9xito")},error:a=>{this.loading.set(!1),this.toastrService.error(a.error?.message||"Error al actualizar perfil","Error"),console.error("Error updating profile:",a)}})}changePassword(){if(this.passwordForm.newPassword!==this.passwordForm.confirmPassword){this.toastrService.error("Las contrase\xF1as no coinciden","Error");return}this.loading.set(!0),this.http.put(`${x.apiUrl}/users/${this.user()?.user_id}`,{password:this.passwordForm.newPassword}).subscribe({next:()=>{this.loading.set(!1),this.toastrService.success("Contrase\xF1a cambiada exitosamente","\xC9xito"),this.passwordForm={currentPassword:"",newPassword:"",confirmPassword:""}},error:a=>{this.loading.set(!1),this.toastrService.error(a.error?.message||"Error al cambiar contrase\xF1a","Error"),console.error("Error changing password:",a)}})}formatDate(a){return a?new Date(a).toLocaleDateString("es-ES",{year:"numeric",month:"long",day:"numeric"}):""}static \u0275fac=function(r){return new(r||g)(_(W),_(I),_(N),_(U))};static \u0275cmp=F({type:g,selectors:[["app-profile"]],decls:23,vars:22,consts:[[1,"min-h-screen","bg-gray-50","py-8"],[1,"max-w-4xl","mx-auto","px-4","sm:px-6","lg:px-8"],[1,"bg-white","rounded-lg","shadow-sm","overflow-hidden"],[1,"bg-gradient-to-r","from-primary-600","to-primary-700","px-6","py-8"],[1,"flex","items-center"],[1,"w-20","h-20","bg-white","rounded-full","flex","items-center","justify-center"],[1,"text-2xl","font-bold","text-primary-600"],[1,"ml-6"],[1,"text-2xl","font-bold","text-white"],[1,"text-primary-100"],[1,"text-primary-100","text-sm"],[1,"border-b","border-gray-200"],[1,"flex","space-x-8","px-6"],[1,"py-4","px-1","border-b-2","font-medium","text-sm","transition-colors","hover:text-primary-600",3,"click"],["class","p-6",4,"ngIf"],[1,"p-6"],[1,"space-y-6",3,"ngSubmit"],[1,"grid","grid-cols-1","md:grid-cols-2","gap-6"],[1,"block","text-sm","font-medium","text-gray-700","mb-1"],["type","text","name","username","required","",1,"w-full","px-3","py-2","border","border-gray-300","rounded-md","focus:ring-2","focus:ring-primary-500","focus:border-transparent",3,"ngModelChange","ngModel"],["type","email","name","email","required","",1,"w-full","px-3","py-2","border","border-gray-300","rounded-md","focus:ring-2","focus:ring-primary-500","focus:border-transparent",3,"ngModelChange","ngModel"],["type","text","name","first_name",1,"w-full","px-3","py-2","border","border-gray-300","rounded-md","focus:ring-2","focus:ring-primary-500","focus:border-transparent",3,"ngModelChange","ngModel"],["type","text","name","last_name",1,"w-full","px-3","py-2","border","border-gray-300","rounded-md","focus:ring-2","focus:ring-primary-500","focus:border-transparent",3,"ngModelChange","ngModel"],["type","tel","name","phone",1,"w-full","px-3","py-2","border","border-gray-300","rounded-md","focus:ring-2","focus:ring-primary-500","focus:border-transparent",3,"ngModelChange","ngModel"],["name","address","rows","3","placeholder","Ingrese su direcci\xF3n completa",1,"w-full","px-3","py-2","border","border-gray-300","rounded-md","focus:ring-2","focus:ring-primary-500","focus:border-transparent",3,"ngModelChange","ngModel"],[1,"flex","justify-end"],["type","submit",1,"bg-primary-600","text-white","px-6","py-2","rounded-md","hover:bg-primary-700","transition-colors","disabled:opacity-50",3,"disabled"],["type","password","name","currentPassword","required","",1,"w-full","px-3","py-2","border","border-gray-300","rounded-md","focus:ring-2","focus:ring-primary-500","focus:border-transparent",3,"ngModelChange","ngModel"],["type","password","name","newPassword","required","",1,"w-full","px-3","py-2","border","border-gray-300","rounded-md","focus:ring-2","focus:ring-primary-500","focus:border-transparent",3,"ngModelChange","ngModel"],["type","password","name","confirmPassword","required","",1,"w-full","px-3","py-2","border","border-gray-300","rounded-md","focus:ring-2","focus:ring-primary-500","focus:border-transparent",3,"ngModelChange","ngModel"]],template:function(r,t){if(r&1&&(n(0,"div",0)(1,"div",1)(2,"div",2)(3,"div",3)(4,"div",4)(5,"div",5)(6,"span",6),l(7),o()(),n(8,"div",7)(9,"h1",8),l(10),o(),n(11,"p",9),l(12),o(),n(13,"p",10),l(14),o()()()(),n(15,"div",11)(16,"nav",12)(17,"button",13),y("click",function(){return t.activeTab="profile"}),l(18," Informaci\xF3n Personal "),o(),n(19,"button",13),y("click",function(){return t.activeTab="security"}),l(20," Seguridad "),o()()(),E(21,H,30,8,"div",14)(22,O,17,5,"div",14),o()()()),r&2){let e,i,P,M;s(7),b(" ",((e=t.user())==null||e.username==null||(e=e.username.charAt(0))==null?null:e.toUpperCase())||"U"," "),s(3),S((i=t.user())==null?null:i.username),s(2),S((P=t.user())==null?null:P.email),s(2),b("Miembro desde ",t.formatDate((M=t.user())==null?null:M.created_at)),s(3),C("border-primary-500",t.activeTab==="profile")("text-primary-600",t.activeTab==="profile")("border-transparent",t.activeTab!=="profile")("text-gray-500",t.activeTab!=="profile"),s(2),C("border-primary-500",t.activeTab==="security")("text-primary-600",t.activeTab==="security")("border-transparent",t.activeTab!=="security")("text-gray-500",t.activeTab!=="security"),s(2),w("ngIf",t.activeTab==="profile"),s(),w("ngIf",t.activeTab==="security")}},dependencies:[V,T,R,k,D,L,B,q,j,A],encapsulation:2})};export{G as ProfileComponent};
