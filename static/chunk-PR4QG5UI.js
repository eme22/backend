import{Dc as d,Fc as p,Hc as m,Lc as h,N as r,Q as n,U as a,ra as o}from"./chunk-J3KRFXTR.js";var u=class i{constructor(t,e){this.http=t;this.platformId=e}apiUrl=h.apiUrl;sessionId=null;isBrowser(){return d(this.platformId)}getFromStorage(t){return this.isBrowser()?localStorage.getItem(t):null}setInStorage(t,e){this.isBrowser()&&localStorage.setItem(t,e)}setSessionId(t){this.isBrowser()&&!this.getSessionId()&&(this.sessionId=t,this.setInStorage("x-session-id",t))}getSessionId(){if(!(!this.sessionId&&(this.sessionId=this.getFromStorage("x-session-id"),!this.sessionId)))return this.sessionId}getHeaders(){let t=new p,e=this.getFromStorage("access_token");e&&(t=t.set("Authorization",`Bearer ${e}`));let s=this.getSessionId();return s&&(t=t.set("x-session-id",s)),t}getCart(){return this.http.get(`${this.apiUrl}/cart`,{headers:this.getHeaders()}).pipe(r(t=>{this.setSessionId(t?.session_id||"")}))}getCartSummary(){return this.http.get(`${this.apiUrl}/cart/summary`,{headers:this.getHeaders()})}addToCart(t){return this.http.post(`${this.apiUrl}/cart/add`,t,{headers:this.getHeaders()}).pipe(r(e=>{this.setSessionId(e?.session_id||"")}))}updateCartItem(t,e){return this.http.patch(`${this.apiUrl}/cart/item/${t}`,e,{headers:this.getHeaders()}).pipe(r(s=>{this.setSessionId(s?.session_id||"")}))}removeFromCart(t){return this.http.delete(`${this.apiUrl}/cart/item/${t}`,{headers:this.getHeaders()}).pipe(r(e=>{this.setSessionId(e?.session_id||"")}))}clearCart(){return this.http.delete(`${this.apiUrl}/cart/clear`,{headers:this.getHeaders()}).pipe(r(t=>{this.setSessionId(t?.session_id||"")}))}mergeCart(){return this.http.post(`${this.apiUrl}/cart/merge`,{},{headers:this.getHeaders()}).pipe(r(t=>{this.setSessionId(t?.session_id||"")}))}static \u0275fac=function(e){return new(e||i)(a(m),a(o))};static \u0275prov=n({token:i,factory:i.\u0275fac,providedIn:"root"})};export{u as a};
