import{b as P,d as N,g as V,m as j,n as $,o as H,s as U}from"./chunk-3BSRKISZ.js";import{$ as h,Eb as A,Fc as F,Ga as I,Gb as i,Hb as _,Ia as a,Ib as o,Ic as y,Kb as O,Lb as w,Mb as C,Oa as T,Va as M,Za as u,_ as v,aa as S,ba as b,ia as x,lb as c,mb as n,nb as t,ob as f,rc as D,sc as k,ub as E,wb as g,xb as p,xc as L}from"./chunk-7IT3E43U.js";function B(l,r){if(l&1){let e=E();n(0,"tr")(1,"td",23),i(2),t(),n(3,"td",24)(4,"div",25),i(5),t(),n(6,"div",26),i(7),t()(),n(8,"td",27),i(9),t(),n(10,"td",24)(11,"span",28),i(12),t()(),n(13,"td",27),i(14),t(),n(15,"td",29)(16,"button",30),g("click",function(){let s=v(e).$implicit,m=p();return h(m.viewOrder(s))}),i(17," Ver "),t(),n(18,"select",31),g("change",function(s){let m=v(e).$implicit,q=p();return h(q.updateOrderStatus(m,s))}),n(19,"option",8),i(20,"Pendiente"),t(),n(21,"option",9),i(22,"En Proceso"),t(),n(23,"option",10),i(24,"Enviado"),t(),n(25,"option",11),i(26,"Entregado"),t(),n(27,"option",12),i(28,"Cancelado"),t()()()()}if(l&2){let e=r.$implicit,d=p();a(2),o(" #",e.order_id," "),a(3),_(e.user==null?null:e.user.username),a(2),_(e.user==null?null:e.user.email),a(2),o(" $",e.total_amount.toLocaleString()," "),a(2),A("bg-yellow-100",e.status==="pending")("text-yellow-800",e.status==="pending")("bg-blue-100",e.status==="processing")("text-blue-800",e.status==="processing")("bg-purple-100",e.status==="shipped")("text-purple-800",e.status==="shipped")("bg-green-100",e.status==="delivered")("text-green-800",e.status==="delivered")("bg-red-100",e.status==="cancelled")("text-red-800",e.status==="cancelled"),a(),o(" ",d.getStatusLabel(e.status)," "),a(2),o(" ",d.formatDate(e.created_at)," "),a(4),c("value",e.status)}}function z(l,r){if(l&1&&(n(0,"div",32)(1,"div",33),S(),n(2,"svg",34),f(3,"path",35),t()(),b(),n(4,"h3",36),i(5),t(),n(6,"p",37),i(7),t()()),l&2){let e=p();a(5),o(" ",e.searchTerm||e.selectedStatus?"No se encontraron pedidos":"No hay pedidos"," "),a(2),o(" ",e.searchTerm||e.selectedStatus?"Intenta con otros filtros de b\xFAsqueda":"Los pedidos aparecer\xE1n aqu\xED cuando los usuarios realicen compras"," ")}}function G(l,r){if(l&1&&f(0,"img",58),l&2){let e=p().$implicit;c("src",e.product.image_url,I)("alt",e.product.name)}}function R(l,r){l&1&&(n(0,"span",59),i(1,"Sin imagen"),t())}function J(l,r){if(l&1&&(n(0,"div",50)(1,"div",51),u(2,G,1,2,"img",52)(3,R,2,0,"span",53),t(),n(4,"div",54)(5,"h4",55),i(6),t(),n(7,"p",56),i(8),t(),n(9,"p",56),i(10),t()(),n(11,"div",57)(12,"p",55),i(13),t()()()),l&2){let e=r.$implicit;a(2),c("ngIf",e.product==null?null:e.product.image_url),a(),c("ngIf",!(e.product!=null&&e.product.image_url)),a(3),_(e.product==null?null:e.product.name),a(2),o("Cantidad: ",e.quantity),a(2),o("Precio unitario: $",e.price.toLocaleString()),a(3),o("$",(e.price*e.quantity).toLocaleString())}}function K(l,r){if(l&1){let e=E();n(0,"div",38)(1,"div",39)(2,"div",40)(3,"h2",41),i(4),t(),n(5,"button",42),g("click",function(){v(e);let s=p();return h(s.selectedOrder=null)}),S(),n(6,"svg",43),f(7,"path",44),t()()(),b(),n(8,"div",45)(9,"div")(10,"h3",46),i(11,"Informaci\xF3n del Cliente"),t(),n(12,"p")(13,"strong"),i(14,"Usuario:"),t(),i(15),t(),n(16,"p")(17,"strong"),i(18,"Email:"),t(),i(19),t(),n(20,"p")(21,"strong"),i(22,"Fecha:"),t(),i(23),t()(),n(24,"div")(25,"h3",46),i(26,"Informaci\xF3n del Pedido"),t(),n(27,"p")(28,"strong"),i(29,"Estado:"),t(),i(30),t(),n(31,"p")(32,"strong"),i(33,"Total:"),t(),i(34),t(),n(35,"p")(36,"strong"),i(37,"\xDAltima actualizaci\xF3n:"),t(),i(38),t()()(),n(39,"div")(40,"h3",47),i(41,"Productos"),t(),n(42,"div",48),u(43,J,14,6,"div",49),t()()()()}if(l&2){let e=p();a(4),o("Detalles del Pedido #",e.selectedOrder.order_id),a(11),o(" ",e.selectedOrder.user==null?null:e.selectedOrder.user.username),a(4),o(" ",e.selectedOrder.user==null?null:e.selectedOrder.user.email),a(4),o(" ",e.formatDate(e.selectedOrder.created_at)),a(7),o(" ",e.getStatusLabel(e.selectedOrder.status)),a(4),o(" $",e.selectedOrder.total_amount.toLocaleString()),a(4),o(" ",e.formatDate(e.selectedOrder.updated_at)),a(5),c("ngForOf",e.selectedOrder.items)}}function Q(l,r){l&1&&(n(0,"div",60),f(1,"div",61),t())}var W=class l{constructor(r){this.http=r}orders=x([]);filteredOrders=x([]);loading=x(!1);error=x(null);selectedOrder=null;searchTerm="";selectedStatus="";ngOnInit(){this.loadOrders()}loadOrders(){this.loading.set(!0),this.http.get(`${y.apiUrl}/orders`).subscribe({next:r=>{this.orders.set(r.orders),this.filteredOrders.set(r.orders),this.loading.set(!1)},error:r=>{this.error.set("Error loading orders"),this.loading.set(!1),console.error("Error loading orders:",r)}})}filterOrders(){let r=this.orders();this.searchTerm&&(r=r.filter(e=>e.order_id.toString().includes(this.searchTerm)||e.user?.username.toLowerCase().includes(this.searchTerm.toLowerCase())||e.user?.email.toLowerCase().includes(this.searchTerm.toLowerCase()))),this.selectedStatus&&(r=r.filter(e=>e.status===this.selectedStatus)),this.filteredOrders.set(r)}viewOrder(r){this.http.get(`${y.apiUrl}/orders/${r.order_id}`).subscribe({next:e=>{this.selectedOrder=e},error:e=>{console.error("Error loading order details:",e)}})}updateOrderStatus(r,e){let d=e.target.value;this.http.patch(`${y.apiUrl}/orders/${r.order_id}/status`,{status:d}).subscribe({next:()=>{r.status=d,this.filteredOrders.set([...this.filteredOrders()])},error:s=>{console.error("Error updating order status:",s)}})}getStatusLabel(r){return{pending:"Pendiente",processing:"En Proceso",shipped:"Enviado",delivered:"Entregado",cancelled:"Cancelado"}[r]||r}formatDate(r){return new Date(r).toLocaleDateString("es-ES")}static \u0275fac=function(e){return new(e||l)(T(F))};static \u0275cmp=M({type:l,selectors:[["app-admin-orders"]],decls:42,vars:6,consts:[[1,"p-6"],[1,"flex","justify-between","items-center","mb-6"],[1,"text-2xl","font-bold","text-gray-900"],[1,"bg-white","p-4","rounded-lg","shadow","mb-6"],[1,"flex","flex-wrap","gap-4"],["type","text","placeholder","Buscar por ID o usuario...",1,"px-4","py-2","border","rounded-lg","focus:ring-2","focus:ring-primary-500","focus:border-transparent",3,"ngModelChange","input","ngModel"],[1,"px-4","py-2","border","rounded-lg","focus:ring-2","focus:ring-primary-500","focus:border-transparent",3,"ngModelChange","change","ngModel"],["value",""],["value","pending"],["value","processing"],["value","shipped"],["value","delivered"],["value","cancelled"],[1,"bg-white","rounded-lg","shadow","overflow-hidden"],[1,"overflow-x-auto"],[1,"min-w-full","divide-y","divide-gray-200"],[1,"bg-gray-50"],[1,"px-6","py-3","text-left","text-xs","font-medium","text-gray-500","uppercase","tracking-wider"],[1,"bg-white","divide-y","divide-gray-200"],[4,"ngFor","ngForOf"],["class","text-center py-12",4,"ngIf"],["class","fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",4,"ngIf"],["class","flex justify-center py-8",4,"ngIf"],[1,"px-6","py-4","whitespace-nowrap","text-sm","font-medium","text-gray-900"],[1,"px-6","py-4","whitespace-nowrap"],[1,"text-sm","font-medium","text-gray-900"],[1,"text-sm","text-gray-500"],[1,"px-6","py-4","whitespace-nowrap","text-sm","text-gray-900"],[1,"px-2","py-1","text-xs","font-medium","rounded-full"],[1,"px-6","py-4","whitespace-nowrap","text-sm","font-medium"],[1,"text-primary-600","hover:text-primary-900","mr-3",3,"click"],[1,"text-sm","border","rounded","px-2","py-1",3,"change","value"],[1,"text-center","py-12"],[1,"mx-auto","w-24","h-24","bg-gray-100","rounded-full","flex","items-center","justify-center","mb-4"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"w-12","h-12","text-gray-400"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M9 5H7a2 2 0 00-2 2v10a2 2 0 002 2h8a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2m-3 7h3m-3 4h3m-6-4h.01M9 16h.01"],[1,"text-lg","font-medium","text-gray-900","mb-2"],[1,"text-gray-500","mb-4"],[1,"fixed","inset-0","bg-black","bg-opacity-50","flex","items-center","justify-center","z-50"],[1,"bg-white","rounded-lg","p-6","w-full","max-w-4xl","max-h-[90vh]","overflow-y-auto"],[1,"flex","justify-between","items-center","mb-4"],[1,"text-xl","font-bold"],[1,"text-gray-500","hover:text-gray-700",3,"click"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"w-6","h-6"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M6 18L18 6M6 6l12 12"],[1,"grid","grid-cols-1","md:grid-cols-2","gap-6","mb-6"],[1,"text-lg","font-semibold","mb-2"],[1,"text-lg","font-semibold","mb-4"],[1,"space-y-4"],["class","flex items-center p-4 bg-gray-50 rounded-lg",4,"ngFor","ngForOf"],[1,"flex","items-center","p-4","bg-gray-50","rounded-lg"],[1,"w-16","h-16","bg-gray-300","rounded-lg","flex","items-center","justify-center","mr-4"],["class","w-full h-full object-cover rounded-lg",3,"src","alt",4,"ngIf"],["class","text-gray-500 text-sm",4,"ngIf"],[1,"flex-1"],[1,"font-medium"],[1,"text-sm","text-gray-600"],[1,"text-right"],[1,"w-full","h-full","object-cover","rounded-lg",3,"src","alt"],[1,"text-gray-500","text-sm"],[1,"flex","justify-center","py-8"],[1,"animate-spin","rounded-full","h-8","w-8","border-b-2","border-primary-600"]],template:function(e,d){e&1&&(n(0,"div",0)(1,"div",1)(2,"h1",2),i(3,"Gesti\xF3n de Pedidos"),t()(),n(4,"div",3)(5,"div",4)(6,"input",5),C("ngModelChange",function(m){return w(d.searchTerm,m)||(d.searchTerm=m),m}),g("input",function(){return d.filterOrders()}),t(),n(7,"select",6),C("ngModelChange",function(m){return w(d.selectedStatus,m)||(d.selectedStatus=m),m}),g("change",function(){return d.filterOrders()}),n(8,"option",7),i(9,"Todos los estados"),t(),n(10,"option",8),i(11,"Pendiente"),t(),n(12,"option",9),i(13,"En Proceso"),t(),n(14,"option",10),i(15,"Enviado"),t(),n(16,"option",11),i(17,"Entregado"),t(),n(18,"option",12),i(19,"Cancelado"),t()()()(),n(20,"div",13)(21,"div",14)(22,"table",15)(23,"thead",16)(24,"tr")(25,"th",17),i(26," ID Pedido "),t(),n(27,"th",17),i(28," Usuario "),t(),n(29,"th",17),i(30," Total "),t(),n(31,"th",17),i(32," Estado "),t(),n(33,"th",17),i(34," Fecha "),t(),n(35,"th",17),i(36," Acciones "),t()()(),n(37,"tbody",18),u(38,B,29,27,"tr",19),t()()(),u(39,z,8,2,"div",20),t(),u(40,K,44,8,"div",21)(41,Q,2,0,"div",22),t()),e&2&&(a(6),O("ngModel",d.searchTerm),a(),O("ngModel",d.selectedStatus),a(31),c("ngForOf",d.filteredOrders()),a(),c("ngIf",!d.loading()&&d.filteredOrders().length===0),a(),c("ngIf",d.selectedOrder),a(),c("ngIf",d.loading()))},dependencies:[L,D,k,U,$,H,P,j,N,V],encapsulation:2})};export{W as AdminOrdersComponent};
