import{a as H,b as O}from"./chunk-LTQIWH4L.js";import{h as W}from"./chunk-HYBTYU64.js";import{a as k,b as N,d as D,e as V,f as j,g as L,h as R,m as q,n as A,o as B,q as P,s as G}from"./chunk-3BSRKISZ.js";import{$ as C,Fc as T,Gb as n,Ia as a,Ib as y,Ic as M,Kb as d,Lb as m,Mb as u,Oa as c,Va as w,Za as b,_ as h,aa as x,ba as S,ia as v,lb as g,mb as r,nb as i,ob as U,sc as F,ub as E,wb as f,xb as _,xc as I}from"./chunk-7IT3E43U.js";function J(l,p){if(l&1){let e=E();r(0,"div")(1,"label",7),n(2,"Contrase\xF1a"),i(),r(3,"input",23),u("ngModelChange",function(s){h(e);let o=_();return m(o.userForm.password,s)||(o.userForm.password=s),C(s)}),i()()}if(l&2){let e=_();a(3),d("ngModel",e.userForm.password)}}function K(l,p){if(l&1&&(r(0,"div",24),n(1),i()),l&2){let e=_();a(),y(" ",e.error()," ")}}var z=class l{constructor(p,e,t,s){this.dialogRef=p;this.data=e;this.toastrService=t;this.http=s;e.mode==="edit"&&e.user&&(this.userForm={username:e.user.username,email:e.user.email,role:e.user.role,password:"",is_active:e.user.is_active})}loading=v(!1);error=v(null);userForm={username:"",email:"",role:"",password:"",is_active:!0};closeModal(){this.dialogRef.close()}saveUser(){this.loading.set(!0),this.error.set(null),(this.data.mode==="create"?this.http.post(`${M.apiUrl}/auth/register`,this.userForm):this.http.put(`${M.apiUrl}/users/${this.data.user.user_id}`,this.userForm)).subscribe({next:e=>{this.loading.set(!1),this.dialogRef.close(e)},error:e=>{this.loading.set(!1),this.error.set(e.error?.message||"Error al guardar usuario"),console.error("Error saving user:",e),this.toastrService.error(e.error?.message||"Error al guardar usuario","Error")}})}static \u0275fac=function(e){return new(e||l)(c(H),c(O),c(W),c(T))};static \u0275cmp=w({type:l,selectors:[["app-user-modal"]],decls:39,vars:9,consts:[[1,"bg-white","rounded-lg","shadow-xl","max-w-md","w-full","mx-4"],[1,"flex","justify-between","items-center","p-6","border-b"],[1,"text-xl","font-bold","text-gray-900"],[1,"text-gray-400","hover:text-gray-600","transition-colors",3,"click"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"w-6","h-6"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M6 18L18 6M6 6l12 12"],[1,"p-6","space-y-4",3,"ngSubmit"],[1,"block","text-sm","font-medium","text-gray-700","mb-1"],["type","text","name","username","required","","placeholder","Ingrese nombre de usuario",1,"w-full","px-3","py-2","border","border-gray-300","rounded-md","focus:ring-2","focus:ring-primary-500","focus:border-transparent",3,"ngModelChange","ngModel"],["type","email","name","email","required","","placeholder","Ingrese email",1,"w-full","px-3","py-2","border","border-gray-300","rounded-md","focus:ring-2","focus:ring-primary-500","focus:border-transparent",3,"ngModelChange","ngModel"],["name","role","required","",1,"w-full","px-3","py-2","border","border-gray-300","rounded-md","focus:ring-2","focus:ring-primary-500","focus:border-transparent",3,"ngModelChange","ngModel"],["value",""],["value","admin"],["value","vendor"],["value","customer"],[4,"ngIf"],[1,"flex","items-center"],["type","checkbox","name","is_active","id","is_active",1,"h-4","w-4","text-primary-600","focus:ring-primary-500","border-gray-300","rounded",3,"ngModelChange","ngModel"],["for","is_active",1,"ml-2","block","text-sm","text-gray-900"],["class","text-red-600 text-sm",4,"ngIf"],[1,"flex","justify-end","space-x-3","pt-4"],["type","button",1,"px-4","py-2","text-sm","font-medium","text-gray-700","bg-gray-100","hover:bg-gray-200","rounded-md","transition-colors",3,"click"],["type","submit",1,"px-4","py-2","text-sm","font-medium","text-white","bg-primary-600","hover:bg-primary-700","rounded-md","transition-colors","disabled:opacity-50",3,"disabled"],["type","password","name","password","required","","placeholder","Ingrese contrase\xF1a",1,"w-full","px-3","py-2","border","border-gray-300","rounded-md","focus:ring-2","focus:ring-primary-500","focus:border-transparent",3,"ngModelChange","ngModel"],[1,"text-red-600","text-sm"]],template:function(e,t){e&1&&(r(0,"div",0)(1,"div",1)(2,"h2",2),n(3),i(),r(4,"button",3),f("click",function(){return t.closeModal()}),x(),r(5,"svg",4),U(6,"path",5),i()()(),S(),r(7,"form",6),f("ngSubmit",function(){return t.saveUser()}),r(8,"div")(9,"label",7),n(10,"Nombre de Usuario"),i(),r(11,"input",8),u("ngModelChange",function(o){return m(t.userForm.username,o)||(t.userForm.username=o),o}),i()(),r(12,"div")(13,"label",7),n(14,"Email"),i(),r(15,"input",9),u("ngModelChange",function(o){return m(t.userForm.email,o)||(t.userForm.email=o),o}),i()(),r(16,"div")(17,"label",7),n(18,"Rol"),i(),r(19,"select",10),u("ngModelChange",function(o){return m(t.userForm.role,o)||(t.userForm.role=o),o}),r(20,"option",11),n(21,"Seleccione un rol"),i(),r(22,"option",12),n(23,"Admin"),i(),r(24,"option",13),n(25,"Vendor"),i(),r(26,"option",14),n(27,"Customer"),i()()(),b(28,J,4,1,"div",15),r(29,"div",16)(30,"input",17),u("ngModelChange",function(o){return m(t.userForm.is_active,o)||(t.userForm.is_active=o),o}),i(),r(31,"label",18),n(32," Usuario activo "),i()(),b(33,K,2,1,"div",19),r(34,"div",20)(35,"button",21),f("click",function(){return t.closeModal()}),n(36," Cancelar "),i(),r(37,"button",22),n(38),i()()()()),e&2&&(a(3),y(" ",t.data.mode==="create"?"Crear Usuario":"Editar Usuario"," "),a(8),d("ngModel",t.userForm.username),a(4),d("ngModel",t.userForm.email),a(4),d("ngModel",t.userForm.role),a(9),g("ngIf",t.data.mode==="create"),a(2),d("ngModel",t.userForm.is_active),a(3),g("ngIf",t.error()),a(4),g("disabled",t.loading()),a(),y(" ",t.loading()?"Guardando...":t.data.mode==="create"?"Crear":"Guardar"," "))},dependencies:[I,F,G,R,A,B,N,k,q,D,V,P,L,j],encapsulation:2})};export{z as a};
